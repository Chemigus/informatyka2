import pygame
import random

# Set up the display
pygame.init()
screen = pygame.display.set_mode((400, 708))
clock = pygame.time.Clock()

# Load the images
background = pygame.image.load("background.png")
bird = pygame.image.load("bird.png")
pipe_down = pygame.image.load("pipe_down.png")
pipe_up = pygame.transform.flip(pipe_down, False, True)

# Set the bird's initial position and velocity
bird_x = 50
bird_y = 250
bird_velocity = 0

# Set the initial positions and velocities of the pipes
pipe_1_x = 400
pipe_1_y = random.randint(-200, 200)
pipe_1_velocity = -2
pipe_2_x = 600
pipe_2_y = random.randint(-200, 200)
pipe_2_velocity = -2

# Set the initial score
score = 0

# Set up the font for the score
font = pygame.font.Font(None, 36)

# Set up the game loop
running = True
while running:
    # Handle events
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False
        if event.type == pygame.KEYDOWN:
            if event.key == pygame.K_SPACE:
                bird_velocity = -5
    
    # Update the bird's position based on its velocity
    bird_y += bird_velocity
    bird_velocity += 0.3
    
    # Update the positions of the pipes based on their velocities
    pipe_1_x += pipe_1_velocity
    pipe_2_x += pipe_2_velocity
    
    # If a pipe goes off the screen, move it back to the right and give it a new y position
    if pipe_1_x < -50:
        pipe_1_x = 400
        pipe_1_y = random.randint(-200, 200)
    if pipe_2_x < -50:
        pipe_2_x = 400
        pipe_2_y = random.randint(-200, 200)
    
    # Check for a collision with the pipes
    if (bird_x + 34 > pipe_1_x and bird_x < pipe_1_x + 50) and (bird_y < pipe_1_y + 420 or bird_y + 24 > pipe_1_y + 420 + 200):
        running = False
    if (bird_x + 34 > pipe_2_x and bird_x < pipe_2_x + 50) and (bird_y < pipe_2_y + 420 or bird_y + 24 > pipe_2_y + 420 + 200):
        running = False
    
    # Check for a collision with the ground or the top of the screen
    if bird_y > 708 or bird_y < 0:
        running = False
    
    # Increment the score if the bird passes a pipe
    if bird_x > pipe_1_x + 50:
